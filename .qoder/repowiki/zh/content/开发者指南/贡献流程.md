# 贡献流程

<cite>
**本文档引用的文件**
- [README.md](file://README.md)
- [pyproject.toml](file://pyproject.toml)
- [scripts/build-whl-local.sh](file://scripts/build-whl-local.sh)
- [vibe_surf/frontend/Dockerfile](file://vibe_surf/frontend/Dockerfile)
- [vibe_surf/frontend/package.json](file://vibe_surf/frontend/package.json)
- [vibe_surf/frontend/biome.json](file://vibe_surf/frontend/biome.json)
- [vibe_surf/backend/main.py](file://vibe_surf/backend/main.py)
- [vibe_surf/frontend/playwright.config.ts](file://vibe_surf/frontend/playwright.config.ts)
- [vibe_surf/frontend/jest.config.js](file://vibe_surf/frontend/jest.config.js)
</cite>

## 目录
1. [开发环境设置](#开发环境设置)
2. [代码风格规范](#代码风格规范)
3. [Pull Request审查流程](#pull-request审查流程)
4. [分支管理策略](#分支管理策略)
5. [安全漏洞报告流程](#安全漏洞报告流程)
6. [新功能开发流程](#新功能开发流程)

## 开发环境设置

VibeSurf项目采用Python和TypeScript技术栈，前端使用React框架，后端使用FastAPI框架。开发者需要设置Python虚拟环境、安装Node.js依赖并启动Docker服务。

### Python虚拟环境创建

项目使用`uv`作为包管理器，推荐使用Python 3.12版本。创建虚拟环境的步骤如下：

```bash
uv venv --python 3.12
source .venv/bin/activate  # Linux/MacOS
# 或
.venv\Scripts\activate     # Windows
uv pip install -e .
```

### Node.js依赖安装

前端项目位于`vibe_surf/frontend`目录，使用npm作为包管理器。安装依赖的步骤如下：

```bash
cd vibe_surf/frontend
npm ci
```

### Docker服务启动

前端项目包含Docker配置，用于容器化部署。Dockerfile配置了Node.js构建环境和Nginx服务器。启动Docker服务的步骤如下：

```bash
cd vibe_surf/frontend
docker build -t vibesurf-frontend .
docker run -p 80:80 vibesurf-frontend
```

**Section sources**
- [README.md](file://README.md#L85-L106)
- [pyproject.toml](file://pyproject.toml#L7)
- [vibe_surf/frontend/Dockerfile](file://vibe_surf/frontend/Dockerfile#L1-L16)

## 代码风格规范

### Python代码规范

Python代码遵循PEP8标准，使用`pydantic`进行数据验证，`fastapi`构建API接口。关键依赖在`pyproject.toml`中定义，包括`fastapi`、`uvicorn`、`langchain`等库。代码中使用类型注解确保类型安全。

### TypeScript代码规范

前端使用TypeScript 5.4.5版本，遵循React最佳实践。代码格式化由Biome工具管理，配置文件为`biome.json`。主要配置包括：
- 缩进使用2个空格
- 字符串使用双引号
- 启用代码组织导入
- 启用多种代码质量检查规则

### Git提交信息格式

提交信息应遵循约定式提交（Conventional Commits）规范，格式为：`<type>(<scope>): <subject>`。常用类型包括：
- `feat`：新增功能
- `fix`：bug修复
- `docs`：文档更新
- `style`：代码格式调整
- `refactor`：代码重构
- `test`：测试相关
- `chore`：构建过程或辅助工具的变动

**Section sources**
- [pyproject.toml](file://pyproject.toml#L19-L250)
- [vibe_surf/frontend/package.json](file://vibe_surf/frontend/package.json#L122-L149)
- [vibe_surf/frontend/biome.json](file://vibe_surf/frontend/biome.json#L12-L106)

## Pull Request审查流程

### 代码审查标准

Pull Request需要至少一位核心开发者审查。审查重点包括：
- 代码功能是否满足需求
- 是否遵循项目代码风格
- 是否有适当的错误处理
- 是否包含必要的类型注解
- 是否影响现有功能的稳定性

### 测试要求

所有代码变更必须通过现有测试套件。新增功能需要提供相应的单元测试和集成测试。测试文件位于`tests/`目录，使用`pytest`框架。前端测试使用Playwright进行端到端测试，配置在`playwright.config.ts`中。

### 文档更新规范

代码变更需要同步更新相关文档。文档位于`docs/`目录，使用Markdown格式。API变更需要更新相应的API文档，用户界面变更需要更新使用说明。

**Section sources**
- [tests/test_agents.py](file://tests/test_agents.py#L1-L391)
- [vibe_surf/frontend/playwright.config.ts](file://vibe_surf/frontend/playwright.config.ts#L1-L128)
- [vibe_surf/frontend/jest.config.js](file://vibe_surf/frontend/jest.config.js#L1-L61)

## 分支管理策略

项目采用Git流分支模型，包含三种主要分支类型：

### 功能分支

功能开发在独立的功能分支上进行，分支命名格式为`feature/<功能名称>`。功能开发完成后，通过Pull Request合并到主分支。功能分支应保持较小的变更范围，便于代码审查。

### 发布分支

发布版本时创建发布分支，命名格式为`release/<版本号>`。发布分支用于版本稳定和bug修复，不接受新功能的合并。发布完成后，发布分支合并到主分支并打上版本标签。

### 主分支

主分支（main）是项目的稳定分支，包含已发布的代码。所有生产环境的部署都基于主分支的代码。只有通过审查的Pull Request才能合并到主分支。

**Section sources**
- [README.md](file://README.md#L87-L91)
- [scripts/build-whl-local.sh](file://scripts/build-whl-local.sh#L1-L215)

## 安全漏洞报告流程

### 敏感信息处理指南

项目使用`.env.example`作为环境变量模板，实际的敏感信息不应提交到代码仓库。API密钥、数据库密码等敏感信息通过环境变量注入。前端代码中避免硬编码敏感信息，使用环境变量进行配置。

### 漏洞报告流程

发现安全漏洞时，应通过私密渠道报告，避免在公开的Issue或Pull Request中讨论。报告应包含：
- 漏洞的详细描述
- 复现步骤
- 潜在影响范围
- 建议的修复方案

核心团队会在收到报告后尽快响应，并在修复完成后发布安全公告。

**Section sources**
- [README.md](file://README.md#L10-L11)
- [.env.example](file://.env.example)

## 新功能开发流程

### 需求讨论

新功能开发前需要在社区进行需求讨论。可以通过Discord或微信社群提出想法，收集反馈。明确功能目标、用户场景和预期效果。

### 设计评审

功能设计需要编写设计文档，包括：
- 功能架构图
- API接口设计
- 数据模型变更
- 用户界面原型

设计文档需要在Pull Request中提交，供团队评审。评审通过后方可开始实现。

### 实现和测试

功能实现应遵循小步提交的原则，每个提交应有清晰的提交信息。实现完成后，编写相应的测试用例，确保功能的正确性和稳定性。测试应覆盖正常流程和异常情况。

**Section sources**
- [README.md](file://README.md#L83-L84)
- [vibe_surf/backend/main.py](file://vibe_surf/backend/main.py#L1-L794)